{% extends 'base.html' %}

{% block title %}{{ client.nom }} - OrderFlow Pro{% endblock %}
{% block page_title %}Détail Client{% endblock %}
{% block breadcrumb %}<span class="mx-2">/</span><a href="/clients" class="hover:text-brand-600">Clients</a><span class="mx-2">/</span><span>{{ client.nom }}</span>{% endblock %}

{% block content %}
<div class="space-y-6">
    <div class="flex items-center gap-4">
        <a href="/clients" class="p-2 bg-slate-100 hover:bg-slate-200 rounded-lg transition">
            <i class="fas fa-arrow-left text-slate-600"></i>
        </a>
        <div class="flex items-center gap-4">
            <div class="w-16 h-16 bg-brand-100 rounded-xl flex items-center justify-center">
                <span class="text-brand-600 font-bold text-2xl">{{ (client.nom or 'N')[0]|upper }}</span>
            </div>
            <div>
                <h2 class="text-2xl font-bold text-slate-800">{{ client.nom or 'Client' }}</h2>
                <p class="text-slate-500">{{ client.entreprise or 'Entreprise non spécifiée' }}</p>
            </div>
        </div>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
        <div class="lg:col-span-2">
            <div class="card">
                <div class="p-5 border-b border-slate-100">
                    <h3 class="font-bold text-slate-800">Historique des commandes</h3>
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full table-pro">
                        <thead>
                            <tr>
                                <th>Référence</th>
                                <th>Produit</th>
                                <th>Quantité</th>
                                <th>Date</th>
                                <th>Statut</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for order in orders %}
                            <tr>
                                <td><a href="/orders/{{ order.id }}" class="text-brand-600 font-medium">{{ order.numero_commande or '#' ~ order.id }}</a></td>
                                <td>{{ order.produit_type or 'N/A' }}</td>
                                <td>{{ "{:,.0f}".format(order.quantite or 0) }} {{ order.unite or '' }}</td>
                                <td>{{ order.date_reception[:10] if order.date_reception else 'N/A' }}</td>
                                <td>
                                    {% if order.statut == 'en_attente' %}
                                    <span class="badge badge-pending">En attente</span>
                                    {% elif order.statut == 'validee' %}
                                    <span class="badge badge-validated">Validée</span>
                                    {% else %}
                                    <span class="badge badge-rejected">Rejetée</span>
                                    {% endif %}
                                </td>
                            </tr>
                            {% else %}
                            <tr><td colspan="5" class="text-center py-8 text-slate-400">Aucune commande</td></tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <div class="card p-5">
            <h3 class="font-bold text-slate-800 mb-4">Informations</h3>
            <div class="space-y-4">
                {% if client.email %}
                <div class="flex items-center gap-3">
                    <i class="fas fa-envelope text-slate-400 w-5"></i>
                    <span class="text-slate-700">{{ client.email }}</span>
                </div>
                {% endif %}
                {% if client.telephone %}
                <div class="flex items-center gap-3">
                    <i class="fas fa-phone text-slate-400 w-5"></i>
                    <span class="text-slate-700">{{ client.telephone }}</span>
                </div>
                {% endif %}
                <div class="pt-4 border-t border-slate-100">
                    <p class="text-sm text-slate-500">Total commandes</p>
                    <p class="text-2xl font-bold text-slate-800">{{ orders|length }}</p>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
